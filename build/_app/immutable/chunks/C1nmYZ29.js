const e=new class{isPlaying=!1;voiceCache=new Map;voicesLoaded=!1;characterVoices=[{id:"sarcastic_narrator",name:"Sarcastic Narrator",description:"Deep, gravelly voice with dramatic pauses and dry wit",voiceSettings:{pitch:.6,rate:.6,volume:.9},personality:{enthusiasm:20,sarcasm:95,warmth:30},voicePreferences:{gender:"male",age:"mature",accent:"american"}},{id:"cheerful_host",name:"Cheerful Host",description:"Bright, bubbly voice with infectious energy and enthusiasm",voiceSettings:{pitch:1.5,rate:1.4,volume:.9},personality:{enthusiasm:95,sarcasm:15,warmth:90},voicePreferences:{gender:"female",age:"young",accent:"american"}},{id:"wise_mentor",name:"Wise Mentor",description:"Smooth, measured voice with wisdom and gentle authority",voiceSettings:{pitch:.8,rate:.7,volume:.8},personality:{enthusiasm:40,sarcasm:70,warmth:85},voicePreferences:{gender:"male",age:"elderly",accent:"british"}},{id:"comedic_sidekick",name:"Comedic Sidekick",description:"Playful, animated voice with lots of personality and humor",voiceSettings:{pitch:1.3,rate:1.3,volume:.9},personality:{enthusiasm:90,sarcasm:80,warmth:75},voicePreferences:{gender:"male",age:"young",accent:"american"}},{id:"dramatic_announcer",name:"Dramatic Announcer",description:"Booming, theatrical voice with dramatic flair and gravitas",voiceSettings:{pitch:.7,rate:.5,volume:1},personality:{enthusiasm:85,sarcasm:60,warmth:40},voicePreferences:{gender:"male",age:"mature",accent:"american"}},{id:"smooth_operator",name:"Smooth Operator",description:"Suave, sophisticated voice with charm and elegance",voiceSettings:{pitch:.9,rate:.8,volume:.85},personality:{enthusiasm:60,sarcasm:85,warmth:70},voicePreferences:{gender:"male",age:"mature",accent:"british"}},{id:"energetic_coach",name:"Energetic Coach",description:"Motivational, passionate voice with infectious energy",voiceSettings:{pitch:1.2,rate:1.5,volume:.95},personality:{enthusiasm:100,sarcasm:50,warmth:80},voicePreferences:{gender:"male",age:"mature",accent:"american"}}];constructor(){this.initializeVoices()}async initializeVoices(){"undefined"!=typeof speechSynthesis?(0===speechSynthesis.getVoices().length&&await new Promise(e=>{const i=()=>{speechSynthesis.removeEventListener("voiceschanged",i),e()};speechSynthesis.addEventListener("voiceschanged",i),setTimeout(e,1e3)}),this.voicesLoaded=!0,this.cacheVoicesForCharacters()):console.warn("Speech synthesis not available")}cacheVoicesForCharacters(){const e=speechSynthesis.getVoices();for(const i of this.characterVoices){const s=this.findBestVoiceForCharacter(e,i);s&&(this.voiceCache.set(i.id,s),console.log(`Cached voice for ${i.name}: ${s.name}`))}}async getAvailableCharacterVoices(){return this.voicesLoaded||await this.initializeVoices(),this.characterVoices}async speakWithCharacter(e,i){const s=this.characterVoices.find(e=>e.id===i);if(s)try{await this.speakWithCharacterEffects(e,s)}catch(c){console.error("Failed to speak with character voice:",c),this.fallbackToRegularTTS(e)}else console.error("Character voice not found:",i)}async speakWithCharacterEffects(e,i){if("undefined"==typeof speechSynthesis)return void console.warn("Speech synthesis not available");this.voicesLoaded||await this.initializeVoices();const s=new SpeechSynthesisUtterance(e);s.rate=i.voiceSettings.rate,s.pitch=i.voiceSettings.pitch,s.volume=i.voiceSettings.volume;let c=this.voiceCache.get(i.id);if(!c){const e=speechSynthesis.getVoices();c=this.findBestVoiceForCharacter(e,i),c&&this.voiceCache.set(i.id,c)}c&&(s.voice=c,console.log(`Using voice for ${i.name}: ${c.name}`)),s.onend=()=>{this.isPlaying=!1},s.onerror=()=>{this.isPlaying=!1},this.isPlaying=!0,speechSynthesis.speak(s)}findBestVoiceForCharacter(e,i){const s=e.filter(e=>/en/i.test(e.lang));if(0===s.length)return e.find(e=>/en/i.test(e.lang))||null;const c=s.map(e=>{let s=0;const c=e.name.toLowerCase(),a=e.lang.toLowerCase();switch("male"===i.voicePreferences.gender?(c.includes("male")||c.includes("david")||c.includes("james")||c.includes("john")||c.includes("mike")||c.includes("tom"))&&(s+=10):"female"===i.voicePreferences.gender&&(c.includes("female")||c.includes("sarah")||c.includes("emma")||c.includes("lisa")||c.includes("anna")||c.includes("sophie"))&&(s+=10),"young"===i.voicePreferences.age?(c.includes("young")||c.includes("teen")||c.includes("kid"))&&(s+=5):"mature"===i.voicePreferences.age?(c.includes("mature")||c.includes("adult")||c.includes("man")||c.includes("woman"))&&(s+=5):"elderly"===i.voicePreferences.age&&(c.includes("elder")||c.includes("senior")||c.includes("old"))&&(s+=5),"british"===i.voicePreferences.accent?(a.includes("gb")||c.includes("british")||c.includes("uk"))&&(s+=8):"american"===i.voicePreferences.accent&&(a.includes("us")||c.includes("american")||c.includes("us"))&&(s+=8),i.id){case"sarcastic_narrator":(c.includes("deep")||c.includes("gravel")||c.includes("rough"))&&(s+=15);break;case"cheerful_host":(c.includes("bright")||c.includes("cheerful")||c.includes("happy"))&&(s+=15);break;case"wise_mentor":(c.includes("wise")||c.includes("calm")||c.includes("gentle"))&&(s+=15);break;case"dramatic_announcer":(c.includes("dramatic")||c.includes("theatrical")||c.includes("booming"))&&(s+=15);break;case"smooth_operator":(c.includes("smooth")||c.includes("suave")||c.includes("sophisticated"))&&(s+=15);break;case"energetic_coach":(c.includes("energetic")||c.includes("motivational")||c.includes("passionate"))&&(s+=15)}return{voice:e,score:s}});return c.sort((e,i)=>i.score-e.score),c[0]?.voice||s[0]}fallbackToRegularTTS(e){if("undefined"==typeof speechSynthesis)return void console.warn("Speech synthesis not available");const i=new SpeechSynthesisUtterance(e);i.rate=1,i.pitch=1,i.volume=.8,i.onend=()=>{this.isPlaying=!1},i.onerror=()=>{this.isPlaying=!1},this.isPlaying=!0,speechSynthesis.speak(i)}stop(){this.isPlaying=!1,"undefined"!=typeof speechSynthesis&&speechSynthesis.cancel()}isCurrentlyPlaying(){return this.isPlaying||"undefined"!=typeof speechSynthesis&&speechSynthesis.speaking}getCharacterVoice(e){return this.characterVoices.find(i=>i.id===e)}getDefaultCharacterVoice(){return this.characterVoices[0]}};export{e as c};
